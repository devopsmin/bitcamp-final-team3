<!DOCTYPE html>
<html>
<head data-th-replace="~{header :: head}">
</head>
<header data-th-replace="~{header :: #page-header}"></header>

<body>
<div class="container my-5">
    <h1 class="text-center mb-4">ì¼ì • ì§ˆë¬¸ ê²Œì‹œíŒ</h1>

    <div data-th-if="${board}" class="border-bottom pb-3 mb-4">
        <div class="d-flex align-items-center mb-3">
            <img data-th-src="${board.writer.userPhoto != null ? board.writer.userPhoto : 'https://via.placeholder.com/400x150'}"
                 alt="User Photo" class="rounded-circle me-3" style="width: 60px; height: 60px;">
            <div>
                <h5 class="mb-1" data-th-text="${board.writer.userNickname}">ë‹‰ë„¤ì„</h5>
                <small class="text-muted">
                    ì‘ì„±ì¼: <span data-th-text="${#calendars.format(board.boardCreatedDate, 'yyyy.MM.dd HH:mm')}">ë‚ ì§œ</span>
                    â€¢ ì¡°íšŒ: <span data-th-text="${board.boardCount}">ì¡°íšŒìˆ˜</span>
                </small>
            </div>
            <div class="ms-auto">
                <button type="button" class="btn btn-outline-secondary btn-sm" data-th-if="${isUserAuthorized}" data-th-onclick="document.getElementById('myForm').submit();">ìˆ˜ì •</button>
                <button class="btn btn-outline-secondary btn-sm" data-th-if="${isUserAuthorized}" data-th-onclick="|if(confirm('ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?'))location.href='@{delete(boardNo=${board.boardNo})}'|">ì‚­ì œ</button>
            </div>
        </div>

        <!-- ì¢‹ì•„ìš” ë° ì¦ê²¨ì°¾ê¸° ë²„íŠ¼ -->
        <div class="d-flex align-items-center">
            <button type="button" id="likeButton" class="btn btn-outline-danger btn-sm me-2"
                    data-th-onclick="|toggleLike(${board.boardNo})|"
                    data-th-text="${isLiked != null and isLiked ? 'â¤ï¸ ì¢‹ì•„ìš” ì·¨ì†Œ' : 'ğŸ¤ ì¢‹ì•„ìš”'}"></button>
            <span id="likeCount" class="me-3" data-th-text="${board.boardLike}">0</span>

            <button type="button" id="favorButton" class="btn btn-outline-warning btn-sm me-2"
                    data-th-onclick="|toggleFavor(${board.boardNo})|"
                    data-th-text="${isFavored != null and isFavored ? 'â­ ì¦ê²¨ì°¾ê¸° ì·¨ì†Œ' : 'âšª ì¦ê²¨ì°¾ê¸°'}"></button>
            <span id="favorCount" data-th-text="${board.boardFavor}">0</span>
        </div>
    </div>

    <form id="myForm" action="view2" method="post" enctype="multipart/form-data">
        <input type="hidden" name="boardNo" data-th-value='${board.boardNo}'>
        <div class="mb-3">
            <label class="form-label">ì œëª©:</label>
            <input name="boardTitle" readonly type="text" class="form-control" data-th-value='${board.boardTitle}'>
        </div>

        <div class="mb-3">
            <label class="form-label">ë‚´ìš©:</label>
            <textarea name="boardContent" readonly class="form-control" rows="10" data-th-text="${board.boardContent}"></textarea>
        </div>

        <div class="mb-3">
            <label class="form-label">íƒœê·¸:</label>
            <input name="boardTag" readonly type="text" class="form-control" data-th-value="${board.boardTag}">
        </div>

        <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-secondary" data-th-onclick="|location.href='@{list}'|">ëª©ë¡</button>
        </div>
    </form>
</div>

<!--<tr data-th-each="trip : ${trips}" data-th-object="${trip}">-->
<!--    <td><span data-th-text="*{tripTitle}">ì œëª©</span></td>-->

<div class="container my-5">
    <div data-th-each="entry : ${groupedSchedules}">
        <h5 class="mb-3" data-th-text="'Day ' + ${entry.key}">1ì¼ì°¨</h5>

        <div class="timeline">
            <div class="timeline-item col-md-4 mb-4" data-th-each="schedule, iter : ${entry.value}" data-th-object="${schedule}">
                <div class="timeline-item p-3 border rounded shadow-sm">
                    <div class="d-flex align-items-center mb-2">
                        <div class="me-3">
                            <div class="badge bg-warning text-dark me-2" style="font-size: 1.25rem;" data-th-text="${iter.index + 1}">1</div>
                        </div>
                        <div>
                            <div class="text-muted small"><i class="bi bi-clock"></i>16:30 ~ 17:15</div>
                            <p class="mb-1 text-primary" data-th-text="*{location.locationName}">ì œëª©</p>
                            <!--                                <p class="mb-0" data-th-text="*{location.locationDescription}">í•©ë• í™”ì‚°</p>-->
                        </div>
                    </div>
                    <div class="d-flex justify-content-between align-items-center">
                        <img data-th-src="${schedule.location.locationPhoto != null ? schedule.location.locationPhoto : 'https://via.placeholder.com/100x100'}"
                             alt="Location Photo" class="img-thumbnail" style="width: 100px; height: 100px;">
                    </div>
                </div>
                <div class="timeline-line mt-2" style="border-left: 2px dotted #ddd; height: 20px; margin-left: 20px;"></div>
            </div>
        </div>
    </div>
</div>

<div data-th-replace="~{question/comment}"></div>

<!-- ìƒë‹¨ ì´ë™ ë²„íŠ¼ -->
<button id="scrollTopButton" onclick="scrollToTop()" style="position: fixed; bottom: 20px; left: 800px; visibility: hidden;">
    â¬†ï¸ ìƒë‹¨ìœ¼ë¡œ ì´ë™
</button>

<script defer>
    function toggleLike(boardNo) {
        fetch(`/question/toggleLike?boardNo=${boardNo}`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' }
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById('likeCount').textContent = data.likeCount;
            document.getElementById('likeButton').textContent = data.isLiked ? 'â¤ï¸ ì¢‹ì•„ìš” ì·¨ì†Œ' : 'ğŸ¤ ì¢‹ì•„ìš”';
            alert(data.message);
        })
        .catch(error => console.error('Error:', error));
    }

    function toggleFavor(boardNo) {
        fetch(`/question/toggleFavor?boardNo=${boardNo}`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' }
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById('favorCount').textContent = data.favorCount;
            document.getElementById('favorButton').textContent = data.isFavored ? 'â­ ì¦ê²¨ì°¾ê¸° ì·¨ì†Œ' : 'âšª ì¦ê²¨ì°¾ê¸°';
            alert(data.message);
        })
        .catch(error => console.error('Error:', error));
    }
</script>

<script>
    // ìƒë‹¨ ì´ë™ í•¨ìˆ˜
   function scrollToTop() {
       window.scrollTo({ top: 0, behavior: 'smooth' });
   }

   // ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ê°ì§€í•˜ì—¬ ë²„íŠ¼ í‘œì‹œ
   window.addEventListener('scroll', function() {
       const scrollTopButton = document.getElementById('scrollTopButton');
       if (window.scrollY > 500) {
           scrollTopButton.style.visibility = "visible";
       } else {
           scrollTopButton.style.visibility = "hidden";
       }
   });
</script>


</body>

</html>
